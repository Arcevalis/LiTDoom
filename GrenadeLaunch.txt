ACTOR GrenadeLauncher : BrutalWeapon
{
	scale 0.348
	Weapon.AmmoUse 0
    Inventory.PickupSound "GLOPEN"
    +WEAPON.NOAUTOAIM
	Weapon.SlotNUMBER 5
	Weapon.SelectionOrder 2500
	Inventory.PickupMessage "$GOTGLAUNCHER"
	  tag "Chimera Multi-purpose Launcher"
	//+WEAPON.CHEATNOTWEAPON
	States
	{
	
	
	INSPECT:
		BADF A 0 A_Takeinventory("neverfoundGL",1)
		GLAN A 0 A_PlaySound("GLINSPECT",1)
		GLAI ABCDEFGHIJKLMNO 1 A_JumpIfInventory("Kicking",1,"InspectCancel")
		GLAI O 8 A_JumpIfInventory("Kicking",1,"InspectCancel")
		GLAI PQRSTUVWXXXXYZ 1 A_JumpIfInventory("Kicking",1,"InspectCancel")
		GL4I AAAAABCDDDDEFGGGHIJKL 1 A_JumpIfInventory("Kicking",1,"InspectCancel")
		GLAN A 0 A_PlaySound("GLOPEN",1)
		GL4I MNOP 1 A_JumpIfInventory("Kicking",1,"InspectCancel")
		GL4I Q 20 A_JumpIfInventory("Kicking",1,"InspectCancel")
		GLAN A 0 A_Giveinventory("GLammo",3)	
		GLAN A 0 A_PlaySound("GLCLOSE",1)
		GL4I RSTU 1 A_JumpIfInventory("Kicking",1,"InspectCancel")
		goto Ready3
		
	
	Ready:
	SelectAnimation:
		TNT1 A 1
		GLAN A 0 A_JumpIfInventory("neverfoundGL",1,"Inspect")
		GLAN A 0 A_PlaySound("GLCLOSE",1)
		GLAN A 0 
        GLAS ABCDEFGHIJJ 1
		GOTO READY3
	Ready3:
        GLAF A 0 A_JumpIfInventory("Kicking",1,"dokickGL")
		GLAF A 0 A_JumpIfInventory("StartDualWield",1,"Changeammo")
		GLAF A 1 A_WeaponReadyLit
        goto ready3
		
	Deselect:
		GLAN A 0
		BADF A 0 A_Takeinventory("GrenadelauncherSelected",1)
		TNT1 A 0 A_JumpIfInventory("weaponbroke", 1, "Deselectcontinue")
        GLAS JJIHGFEDCBA 1
	Deselectcontinue:
		TNT1 AAAAAAAAA 0 A_Lower
		TNT1 A 1 A_Lower
		Wait
		
	goingtoaction:
		GLAN A 0
        GLAS JIHGFEDCBA 1
		TNT1 A 0 A_JumpIfInventory("weargasmask", 1, "wearanimation")
		TNT1 A 0 A_JumpIfInventory("removegasmask", 1, "removeanimation")
		TNT1 A 0 A_JumpIfInventory("battledrugtoken",1,"drugshot")
		TNT1 A 0 A_JumpIfInventory("BANDAGETOKEN",1,"BANDAGE")
		goto repair
		
	Select: 
		TNT1 A 0 A_Overlay(-10,"FirstPersonLegsStand")
		TNT1 A 0 a_removelight(1)
		TNT1 A 0 A_removelight(2)	
		TNT1 A 0 {if(GetCVAR("bd_SmartCrosshairs") == 1){A_SetCrosshair(GetCVAR("GLCrosshair"));}else{A_SetCrosshair(0);}}	
		TNT1 A 0 SetPlayerProperty(0,0,2)
		TNT1 A 0 A_SetRoll(0)
		TNT1 A 0 ACS_NAMEDEXECUTE("WEAPONSELECT",0)
		GLAN A 0 A_Giveinventory("GoSpecial",1)	
		GLAF A 1 A_RAISE
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
		Goto READY
		
	Fire:
		TNT1 A 0
		TNT1 A 0 A_JumpIfInventory("GLAmmo", 1, 2)
		Goto NoAmmo
		TNT1 A 0
		
		//DURABILITY CHECK
		TNT1 A 0 A_JumpIFInventory("FirearmsdurabilityOFF", 1, 4)
		PIST F 0 A_Takeinventory("GLDurability",1)
		PIST F 0 A_JumpIfInventory("GLDurability",24, 2)
		PIST F 0 A_Jump(80, "Misfire")
		///
		
		TNT1 A 0 A_TakeInventory("GLAmmo", 1)
		GLAN A 0 A_FireCustomMissile("RedFlareSpawn",-5,0,0,0)
		TNT1 AAAAAA 0 BRIGHT A_FireCustomMissile("ShotgunParticles", random(-16,16), 0, -1, random(-9,9))
		GLAN A 0 A_PlaySound("glfire",1)
		GLAN A 0 A_FireCustomMissile("GrenadeMissileBreaksGlass", 0, 0, 0, 0)
		GLAN A 0 A_ZoomFactor(0.9)
		GLAN A 0 A_Recoil(4)
		GLAN A 0 A_Jump(255, "fire1","fire2")
		
		FIRE1:
		GLAF C 1 BRIGHT 
        GLAF D 1
		GLAN A 0 A_ZoomFactor(1.0)
		
		FIRE2:
		GLAF J 1 BRIGHT 
        GLAF K 1
		GLAN A 0 A_ZoomFactor(1.0)
		
		FIREPROJECTILE:
		PIST F 0 A_JumpIfInventory("Flareloaded",1, "fireflare")
		PIST F 0 A_JumpIfInventory("acidloaded",1, "fireacid")
		PIST F 0 A_JumpIfInventory("hellfireloaded",1, "firehellfire")
		PIST F 0 A_JumpIfInventory("syringeloaded",1, "firesyringe")
		PIST F 0 A_JumpIfInventory("metalloaded",1, "firemetal")
		PIST F 0 A_JumpIfInventory("grenadeloaded",1, "firegrenade")
		PIST F 0 A_JumpIfInventory("clusterloaded",1, "firecluster")
		PIST F 0 A_JumpIfInventory("mineloaded",1, "firemine")
	FIREFLARE:
		GLAN A 0 A_FireCustomMissile("ActiveflareGL", 0, 1, 0, 0)
		goto afterfire
	FIREACID:
		GLAN A 0 A_FireCustomMissile("AcidmistGL1", 0, 1, 0, 0)
		goto afterfire
	FIREHELLFIRE:
		GLAN A 0 A_FireCustomMissile("HellfireGL1", 0, 1, 0, 0)
		goto afterfire
	FIRESYRINGE:
		GLAN A 0 A_FireCustomMissile("SYRINGEGL1", 0, 1, 0, 0)
		goto afterfire
	FIREMETAL:
		GLAN AA 0 A_FireCustomMissile("ShrapnelPieceDamaging", random(-1,1), 1, random(-5,5), random(-2,2),0, random(-7,7))
		GLAN AA 0 A_FIRECustomMissile("Shrapnel1", random(-2,2), 0, random(-9,9), random(-2,2),0, random(-3,3))
		GLAN AA 0 A_FIRECustomMissile("Shrapnel2",random(-2,2), 0, random(-9,9), random(-2,2),0, random(-3,3))
		GLAN AA 0 A_FIRECustomMissile("Shrapnel3", random(-2,2), 0, random(-9,9), random(-2,2),0, random(-3,3))
		goto afterfire
	FIREGRENADE:
		GLAN A 0 A_FireCustomMissile("shortgrenade", 0, 1, 0, 0)
		goto afterfire
	FIRECLUSTER:
		GLAN A 0 A_FireCustomMissile("CLUSTERGL1", 0, 1, 0, 0)
		goto afterfire
	FIREMINE:
		GLAN A 0 A_FireCustomMissile("ProxBombGL", 0, 1, 0, 0)
		goto afterfire
		
		AFTERFIRE:
		GLAN A 0 A_Jump(255, "smoke1","smoke2")
				
		SMOKE1:
		GLAN A 0 A_SetPitch(-8.0 + pitch)
		GLAF EFGH 1 A_SetPitch(1.0 + pitch)
		goto finishfire
		
		SMOKE2:
		GLAN A 0 A_SetPitch(-8.0 + pitch)
		GLAF  LMNO 1 A_SetPitch(1.0 + pitch)
		
		FINISHFIRE:
		/// DURABILITY CHECK 2
		PIST F 0 A_JumpIfInventory("GLdurability", 1, 1)
		goto weaponbreak
		TNT1 A 0
		///
		GLAF A 3
		GLAN A 0 A_PlaySound("GLPUMP",2)
		GLAF PQRR 1
		GLAF SSSS 1
		GLAF TTUVWX 1 A_SetPitch(1.0 + pitch)
		GLAF A 1
		Goto READY3
		
	AltFire:
		TNT1 A 0
		PIST F 0 A_JumpIfInventory("mineloaded",1, "altfiremine")
		TNT1 A 0 A_JumpIfInventory("GLAmmo", 1, 2)
		Goto NoAmmo
		TNT1 A 0
		
		//DURABILITY CHECK
		TNT1 A 0 A_JumpIFInventory("FirearmsdurabilityOFF", 1, 4)
		PIST F 0 A_Takeinventory("GLDurability",1)
		PIST F 0 A_JumpIfInventory("GLDurability",24, 2)
		PIST F 0 A_Jump(80, "Misfire")
		///
		
		TNT1 A 0 A_TakeInventory("GLAmmo", 1)
		GLAN A 0 A_FireCustomMissile("RedFlareSpawn",-5,0,0,0)
		TNT1 AAAAAA 0 BRIGHT A_FireCustomMissile("ShotgunParticles", random(-16,16), 0, -1, random(-9,9))
		GLAN A 0 A_PlaySound("glfire",1)
		GLAN A 0 A_FireCustomMissile("GrenadeMissileBreaksGlass", 0, 0, 0, 0)
		GLAN A 0 A_Jump(255, "ALTfire1","ALTfire2")
		
		ALTFIRE1:
		GLAF C 1 BRIGHT 
        GLAF D 1
		GLAN A 0 A_ZoomFactor(1.0)
		
		ALTFIRE2:
		GLAF J 1 BRIGHT 
        GLAF K 1
		GLAN A 0 A_ZoomFactor(1.0)
		
	ALTFIREPROJECTILE:
		PIST F 0 A_JumpIfInventory("Flareloaded",1, "altfireflare")
		PIST F 0 A_JumpIfInventory("acidloaded",1, "altfireacid")
		PIST F 0 A_JumpIfInventory("hellfireloaded",1, "altfirehellfire")
		PIST F 0 A_JumpIfInventory("syringeloaded",1, "altfiresyringe")
		PIST F 0 A_JumpIfInventory("metalloaded",1, "altfiremetal")
		PIST F 0 A_JumpIfInventory("grenadeloaded",1, "altfiregrenade")
		PIST F 0 A_JumpIfInventory("clusterloaded",1, "altfirecluster")
		PIST F 0 A_JumpIfInventory("mineloaded",1, "altfiremine")
	ALTFIREFLARE:
		GLAN A 0 A_FireCustomMissile("EXPLODINGflare", 0, 1, 0, 0)
		goto ALTafterfire
	ALTFIREACID:
		GLAN A 0 A_FireCustomMissile("ACIDMISTGL2", 0, 1, 0, 0)
		goto ALTafterfire
	ALTFIREHELLFIRE:
		FLMT AA 0 BRIGHT A_FireCustomMissile("Hellfiregl2", 0, 1, 0, -12, 0, 8)
		FLMT A 0 BRIGHT A_FireCustomMissile("FLAMETHROWERMISSILEPROPER", 0, 1, 0, -12, 0, 8)
		goto ALTafterfire
	ALTFIRESYRINGE:
		GLAN A 0 A_FireCustomMissile("SYRINGEGL2", 0, 1, 0, 0)
		goto ALTafterfire
	ALTFIREMETAL:
		GLAN A 0 A_FireCustomMissile("SPIKEGL2", 0, 1, 0, 0)
		goto ALTafterfire
	ALTFIREGRENADE:
		GLAN A 0 A_FireCustomMissile("grenademissile", 0, 1, 0, 0)
		goto ALTafterfire
	ALTFIRECLUSTER:
		GLAN A 0 A_FireCustomMissile("CLUSTERGL2", 0, 1, 0, 0)
		goto ALTafterfire
	ALTFIREMINE:
		TNT1 A 0 A_OVERLAY(3,"DETONATORPRESS")
		GLAS JIHGFEDDDDEFGHIJ 2
	GOTO READY3
		
		ALTAFTERFIRE:
		GLAN A 0 A_Jump(255, "ALTsmoke1","ALTsmoke2")
		
		
		ALTSMOKE1:
		GLAN A 0 A_SetPitch(-8.0 + pitch)
		GLAF EFGH 1 A_SetPitch(1.0 + pitch)
		goto finishfire
		
		ALTSMOKE2:
		GLAN A 0 A_SetPitch(-8.0 + pitch)
		GLAF  LMNO 1 A_SetPitch(1.0 + pitch)
        Goto finishfire

Detonatorpress:
	TNT1 A 0 {a_overlayflags(3, pspf_flip, 1); a_overlayflags(3, pspf_mirror, 1);}
	DETO LMNOPPP 2 A_overlayoffset(3,-80,0)
	DETO A 0 A_SPAWNITEM("DETONATIONTRIGGER",0,0,0)
	DETO PPQRS 2 A_overlayoffset(3,-80,0)
	TNT1 A 0 {a_overlayflags(3, pspf_flip, 0); a_overlayflags(3, pspf_mirror, 0);}
	STOP

///////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////// RELOAD
///////////////////////////////////////////////////////////////////////////////////
		
	Reload:	
		TNT1 A 0
		TNT1 A 0 A_TakeInventory("Reloading", 1)
		PIST F 0 A_JumpIfInventory("REPAIRMODE",1,"KITREPAIR")
		
		TNT1 A 0 A_JumpIfInventory("GLAmmo", 6, "Ready3")
		TNT1 AA 0
		
		GL4R ABC 1
		GL4R A 0 A_PlaySound("GLOPEN",1)
		GL4R C 1 A_FireCustomMissile("SmokeSpawner",0,0,0,5)
		GL4R D 1 A_FireCustomMissile("SmokeSpawner",0,0,0,5)
		GL4R DEFGHIJKLMNOPQRSTUVWXXXX 1 A_JumpIfInventory("Kicking",1,"dokickGL")
		
	INSERTROUNDS:
		SHTN A 0
	
	///PICK AMMO TYPE
	SHTN A 0 A_JumpIfInventory("flareloaded",1,"RELOADFLARE")
	SHTN A 0 A_JumpIfInventory("acidloaded",1,"RELOADacid")
	SHTN A 0 A_JumpIfInventory("hellfireloaded",1,"RELOADhellfire")
	SHTN A 0 A_JumpIfInventory("syringeloaded",1,"RELOADsyringe")
	SHTN A 0 A_JumpIfInventory("metalloaded",1,"RELOADmetal")
	SHTN A 0 A_JumpIfInventory("grenadeloaded",1,"RELOADgrenade")
	SHTN A 0 A_JumpIfInventory("clusterloaded",1,"RELOADcluster")
	SHTN A 0 A_JumpIfInventory("mineloaded",1,"RELOADmine")
	GOTO CONTINUERELOAD
	///////
	
	RELOADFLARE:
		SHTN A 0 A_JumpIfInventory("flare",1,"RELOADFLARE2")
		goto continuereload
	RELOADFLARE2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("FLARE",1)
		goto insertanimation
		
	RELOADACID:
		SHTN A 0 A_JumpIfInventory("ACIDMISTAMMO",1,"RELOADACID2")
		goto continuereload
	RELOADACID2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("ACIDMISTAMMO",1)
		goto insertanimation
		
	RELOADHELLFIRE:
		SHTN A 0 A_JumpIfInventory("HELLFIREAMMO",1,"RELOADHELLFIRE2")
		goto continuereload
	RELOADHELLFIRE2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("HELLFIREAMMO",1)
		goto insertanimation
		
	RELOADSYRINGE:
		SHTN A 0 A_JumpIfInventory("PHEROMONES",1,"RELOADSYRINGE2")
		goto continuereload
	RELOADSYRINGE2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("PHEROMONES",1)
		goto insertanimation
	
	RELOADMETAL:
		SHTN A 0 A_JumpIfInventory("SCRAPMETAL",1,"RELOADMETAL2")
		goto continuereload
	RELOADMETAL2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("SCRAPMETAL",1)
		goto insertanimation
	
	RELOADGRENADE:
		SHTN A 0 A_JumpIfInventory("grenadeammo",1,"RELOADGRENADE2")
		goto continuereload
	RELOADGRENADE2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("grenadeammo",1)
		goto insertanimation
		
	RELOADCLUSTER:
		SHTN A 0 A_JumpIfInventory("CLUSTERAMMO",1,"RELOADCLUSTER2")
		goto continuereload
	RELOADCLUSTER2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("CLUSTERAMMO",1)
		goto insertanimation
		
	RELOADMINE:
		SHTN A 0 A_JumpIfInventory("PROXBOMBAMMO",1,"RELOADMINE2")
		goto continuereload
	RELOADMINE2:
		SSHR A 0 A_TakeInventory("Reloading", 1)
        SHTN A 0 A_JumpIfInventory("GLAMMO",6,"Continuereload")
        SHTN A 0 A_Giveinventory("GLammo",1)
		SHTN A 0 A_Takeinventory("PROXBOMBAMMO",1)
		goto insertanimation
		
	//////////
		
	INSERTANIMATION:
		GLAR AAABC 1 A_JumpIfInventory("Kicking",1,"dokickGL")
		GLAN A 0 A_PlaySound("weapons/reloadgrenade",2)
		GLAR DE 1 A_JumpIfInventory("Kicking",1,"dokickGL")
		GLAR FGH 1 A_JumpIfInventory("Kicking",1,"dokickGL")
		GLAR IIIIIIIIIIIIII 1 A_WEAPONREADY
		TNT1 A 0 A_TakeInventory("Reloading", 1)
		Goto INSERTROUNDS
		
	CONTINUERELOAD:
		GL4R XWVUTSRQPON 1
		GL4R A 0 A_PlaySound("GLCLOSE",1)
		GLAF SRQP 1
		TNT1 A 0 A_TakeInventory("HasUnloaded", 1)
		GOTO READY3
		
///////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////// UNLOAD
///////////////////////////////////////////////////////////////////////////////////

	  Checkdrum:
		GL4R I 5 A_weaponready(WRF_NOFIRE | WRF_NOSWITCH)
		TNT1 A 0 A_JumpIFInventory("FirearmsdurabilityOFF", 1, 2)
		TNT1 A 0 ACS_NAMEDEXECUTEalways("grenadeDURABILITYCHECK",0)
		TNT1 A 0 ACS_NamedExecutealways("GLMAGCheck",0)
		TNT1 A 0 ACS_NamedExecutealways("GLAMMOTYPECHECK",0)
		TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USER4, "Checkdrum")
		
		GL4R JKLMN 1
		GL4R A 0 A_PlaySound("GLCLOSE",1)
		GLAF SRQP 1
		 goto Ready3

	WeaponCheckOverlay:
		TNT1 A 5
		PISA D 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USER4, 1)
		Stop
	WeaponCheck2:
		TNT1 A 1
		TNT1 A 0 A_JumpIFInventory("FirearmsdurabilityOFF", 1, 2)
		PISA D 0 ACS_NamedExecutealways("Grenadedurabilitycheck", 0)
		PISA D 0 ACS_NamedExecutealways("GLmagcheck", 0)
		TNT1 A 0 ACS_NamedExecutealways("GLAMMOTYPECHECK",0)
		PISA D 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USER4, "WeaponCheck2")
		stop	
	NoAmmoUnload:
	    PISA D 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USER4, 1)
		goto Noammo
		TNT1 A 0 A_Overlay(98,"WeaponCheckOverlay",false)
	Noammo:
		TNT1 A 0 A_PlaySound("DRYFIRE")
	Noammo2:
		GLAF A 10 
		TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USER4, "Noammo2")
		goto Ready3


	user4:	
		GLAF A 1
		TNT1 A 0 A_TakeInventory("Reloading", 1)
		TNT1 A 0 A_JumpIfInventory("GLAmmo", 1, 2)
		GLAF A 1 
		Goto NoammoUnload
		TNT1 AA 0
		GL4R ABC 1
		GL4R A 0 A_PlaySound("GLOPEN",1)
		GL4R DEFGHI 1
		TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USER4, "Checkdrum")
		GL4R JKLMNOPQRSTUVWX 1
		
	REMOVEROUNDS:
	///PICK AMMO TYPE
	SHTN A 0 A_JumpIfInventory("flareloaded",1,"REMOVEFLARE")
	SHTN A 0 A_JumpIfInventory("acidloaded",1,"REMOVEacid")
	SHTN A 0 A_JumpIfInventory("hellfireloaded",1,"REMOVEhellfire")
	SHTN A 0 A_JumpIfInventory("syringeloaded",1,"REMOVEsyringe")
	SHTN A 0 A_JumpIfInventory("metalloaded",1,"REMOVEmetal")
	SHTN A 0 A_JumpIfInventory("grenadeloaded",1,"REMOVEgrenade")
	SHTN A 0 A_JumpIfInventory("clusterloaded",1,"REMOVEcluster")
	SHTN A 0 A_JumpIfInventory("mineloaded",1,"REMOVEmine")
	GOTO CONTINUERELOAD
	///////
	
	REMOVEFLARE:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVEFLARE2")
		goto FINISHUNLOAD
	REMOVEFLARE2:
        SHTN A 0 A_Giveinventory("FLARE",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	REMOVEACID:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVEACID2")
		goto FINISHUNLOAD
	REMOVEACID2:
        SHTN A 0 A_Giveinventory("ACIDMISTAMMO",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	REMOVEHELLFIRE:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVEHELLFIRE2")
		goto FINISHUNLOAD
	REMOVEHELLFIRE2:
        SHTN A 0 A_Giveinventory("HELLFIREAMMO",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	REMOVESYRINGE:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVESYRINGE2")
		goto FINISHUNLOAD
	REMOVESYRINGE2:
        SHTN A 0 A_Giveinventory("PHEROMONES",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	REMOVEMETAL:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVEMETAL2")
		goto FINISHUNLOAD
	REMOVEMETAL2:
        SHTN A 0 A_Giveinventory("SCRAPMETAL",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	REMOVEGRENADE:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVEGRENADE2")
		goto FINISHUNLOAD
	REMOVEGRENADE2:
        SHTN A 0 A_Giveinventory("GRENADEAMMO",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	REMOVECLUSTER:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVECLUSTER2")
		goto FINISHUNLOAD
	REMOVECLUSTER2:
        SHTN A 0 A_Giveinventory("CLUSTERAMMO",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	REMOVEMINE:
		SHTN A 0 A_JumpIfInventory("GLAMMO",1,"REMOVEMINE2")
		goto FINISHUNLOAD
	REMOVEMINE2:
        SHTN A 0 A_Giveinventory("PROXBOMBAMMO",1)
		SHTN A 0 A_Takeinventory("GLAMMO",1)
		goto UNLOADANIMATION
		
	UNLOADANIMATION:
		GLAN A 0 A_PlaySound("Weapons/GrenadeClose")
		GLAR IHGF 1
		GLAN A 0 A_PlaySound("Weapons/GrenadeLoad")
		GLAR EDCBA 1
		TNT1 A 0 A_TakeInventory("Reloading", 1)
		Goto REMOVEROUNDS
		
		FINISHUNLOAD:
		GL4R XWVUTSRQPON 1
		GL4R A 0 A_PlaySound("GLCLOSE",1)
		GLAF SRQP 1
		TNT1 A 0 A_GIVEInventory("HasUnloaded", 1)
		GOTO READY3

///////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////// 
///////////////////////////////////////////////////////////////////////////////////
		
	NoAmmo:
		RIFG A 0
		RIFG A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_PlaySound("weapons/empty", 4)
		GLAF A 5 
		Goto Ready3	

	CheckSprint:
		GLAF A 1 A_WeaponReady(WRF_NOFIRE)
		GLAN A 0 A_JumpIfInventory("IsStandingStill", 1, "Ready3")
		GLAN A 0 A_JumpIfInventory("IsTacticalClass", 1, "StartSprint")
		Goto Ready3
		
	StartSprint:
		TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_FORWARD, 1)
		GOTO READY3
		GLAS JDCB 1 A_WeaponReady(WRF_NOFIRE)
		GLAN A 0 A_Takeinventory("Zoomed",1)
		GLAN A 0 A_Takeinventory("ADSmode",1)
		GLAN A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_JumpIfInventory("LARGESTAMINA", 1, 2)
		TNT1 A 0 A_JumpIfInventory("UsedStamina", 70, "Trip")
		TNT1 A 0 A_JumpIfInventory("UsedStamina", 1400, "Trip")
		
	Sprinting:	
		GL4R X 1
		GLAN S 0 offset(-9,32) 
		GLAN A 0 offset(-9,32) A_JumpIfInventory("IsStandingStill", 1, "Ready3")
		TNT1 A 0 A_JumpIfInventory("LARGESTAMINA", 1, 2)
		TNT1 A 0 A_JumpIfInventory("UsedStamina", 100, "StopSprintTired")
		TNT1 A 0 A_JumpIfInventory("UsedStamina", 2000, "StopSprintTired")
		TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_FORWARD, 1)
		GOTO StopSprint
		PLAY A 0 offset(-9,32) ACS_ExecuteAlways(852, 0, 0, 0, 0)//Makes player faster.
		GLAN A 0 offset(-9,32) A_JumpIfInventory("Powerstrength2", 1, 2)
		GLAN A 0 offset(-9,32) A_GiveInventory("UsedStamina", 8)
		GLAN A 0 offset(-9,32)
		GL4R X 1 offset(-9,34) A_SetPitch(pitch -0.5)
		GL4R X 1 offset(-6,36) A_SetPitch(pitch -0.5)
		GL4R X 1 offset(-3,38) A_SetPitch(pitch -0.5)
		GL4R X 1 offset(0,38) A_SetPitch(pitch -0.5)
		GL4R X 1 offset(3,36) A_SetPitch(pitch -0.5)
		GL4R X 1 offset(6,34) A_SetPitch(pitch -0.5)
		GL4R X 1 offset(9,32) A_SetPitch(pitch -0.5)
		GLAN A 0 offset(9,32) A_WeaponReady(WRF_NOBOB)
		GLAN A 0 A_JumpIfInventory("Kicking",1,"dokickGL")
        GLAN A 0 A_JumpIfInventory("Taunting",1,"Taunt")
        GLAN A 0 
		GLAN A 0 offset(-9,32) A_GiveInventory("UsedStamina", 5)
		GLAN A 0 offset(9,33) A_SpawnItemEx("FootStep", 0, 0, 2, 0, 0, -4)
		GL4R X 1 offset(9,34) A_SetPitch(pitch +0.5)
		GL4R X 1 offset(6,36) A_SetPitch(pitch +0.5)
		GL4R X 1 offset(3,38) A_SetPitch(pitch +0.5)
		GL4R X 1 offset(0,38) A_SetPitch(pitch +0.5)
		GL4R X 1 offset(-3,36) A_SetPitch(pitch +0.5)
		GL4R X 1 offset(-6,34) A_SetPitch(pitch +0.5)
		GL4R X 1 offset(-9,32) A_SetPitch(pitch +0.5)
		GLAN A 0 offset(-9,32) A_WeaponReady(WRF_NOBOB)
		GLAN A 0 offset(-9,32) A_JumpIfInventory("IsRunning", 1, "Sprinting")
		Goto StopSprint
		
	StopSprintTired:
		GLAS BCDJ 1
		PLAY A 0 ACS_ExecuteAlways(853, 0, 0, 0, 0)//Makes player slower.
		GLAN A 0 A_PlaySound("Tired", 2)
		GLAN A 0 A_TakeInventory("usedstamina", 1)
		TNT1 A 0 A_Jumpifhealthlower(25,"rupturesprint")													   
		GLAF A 5 A_WeaponReady
		GLAN A 0 A_TakeInventory("usedstamina", 1)
		GLAF A 5 A_WeaponReady
		GLAN A 0 A_TakeInventory("usedstamina", 1)
		GLAF A 5 A_WeaponReady
		GLAN A 0 A_TakeInventory("usedstamina", 1)
		GLAF A 5 A_WeaponReady
		GLAN A 0 A_TakeInventory("usedstamina", 1)
		GLAF A 5 A_WeaponReady
		Goto Ready3
	StopSprint:
		GLAS BCDJ 1
		TNT1 A 0 A_JumpIfInventory("LARGESTAMINA", 1, 2)
		TNT1 A 0 A_JumpIfInventory("UsedStamina", 70, "StopSprintTired")
		TNT1 A 0 A_JumpIfInventory("UsedStamina", 1400, "StopSprintTired")
		PLAY A 0 ACS_ExecuteAlways(853, 0, 0, 0, 0)//Makes player slower.
		Goto Ready3
	
		Misfire:
		TNT1 A 0 A_playsound("DRYFIRE")
		GLAN A 0 A_Giveinventory("GLdurability",1)
		GLAF A 17
		goto Ready3
		
		Weaponbreak:
		TNT1 A 0 a_print("your Grenade Launcher has broken!")
		GLAS JIHFECBA 1
		TNT1 A 1
		TNT1 A 0 a_SPAWNITEM("brokenGL",0,0)
		 TNT1 A 0 a_RADIUSGIVE("hasbeendropped",90, RGF_OBJECTS | RGF_NOSIGHT, 1, "brokenGL")
		TNT1 A 0 ACS_namedexecute("BROKENDISARM",0)
		TNT1 AAA 1 a_weaponready
		Wait
	
///////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////// CHOOSE AMMO TYPES
///////////////////////////////////////////////////////////////////////////////////

/////////////// CHOOSE

	Changeammo:
		GLAF A 1 
		TNT1 A 0 A_takeinventory("Startdualwield",1)
		TNT1 A 0 A_jumpifinventory("GLAmmo",1,1)
		goto Ammomenu
		TNT1 A 0 A_jumpifinventory("mineloaded",1,3)
		GLAF A 1
		TNT1 A 0 a_print("You need to unload before changing ammo type.")
		goto Ready3
		TNT1 A 0 A_playsound("BEP")
		TNT1 A 0 A_jumpifinventory("detonationmode",1,2)
		TNT1 A 0 A_giveinventory("detonationmode",1)
		goto Ready3
		TNT1 A 0 A_takeinventory("detonationmode",1)
		goto Ready3
		
	AmmoMenu:	
		GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
		TNT1 A 0 A_jumpifinventory("flareloaded",1,"FlareSelected")
		TNT1 A 0 A_jumpifinventory("acidloaded",1,"acidSelected")
		TNT1 A 0 A_jumpifinventory("hellfireloaded",1,"hellfireSelected")
		TNT1 A 0 A_jumpifinventory("syringeloaded",1,"syringeSelected")
		TNT1 A 0 A_jumpifinventory("metalloaded",1,"metalSelected")
		TNT1 A 0 A_jumpifinventory("grenadeloaded",1,"GrenadeSelected")
		TNT1 A 0 A_jumpifinventory("clusterloaded",1,"clusterSelected")
		TNT1 A 0 A_jumpifinventory("mineloaded",1,"mineSelected")
		loop
		
	FlareSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "flareSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "flareSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	Flareloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selectFlares",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "MineSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "AcidSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadFlare")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadFlare")
	loop
	
	AcidSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "acidSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "acidSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	ACIDloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selectacid",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "FlareSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "HellfireSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadAcid")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadAcid")
	loop
	
	HellfireSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "hellfireSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "hellfireSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	Hellfireloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selecthellfire",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "AcidSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "SyringeSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadHellfire")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadHellfire")
	loop
	
	SyringeSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "syringeSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "syringeSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	Syringeloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selectsyringe",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "HellfireSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "MetalSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadSyringe")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadSyringe")
	loop
	
	MetalSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "metalSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "metalSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	Metalloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selectmetal",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "SyringeSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "GrenadeSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadMetal")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadMetal")
	loop
	
	GrenadeSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "grenadeSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "grenadeSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	Grenadeloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selectgrenade",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "MetalSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "ClusterSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadGrenade")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadGRENADE")
	loop
	
	ClusterSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "clusterSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "clusterSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	Clusterloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selectcluster",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "GrenadeSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "MineSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadCluster")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadCluster")
	loop
	
	MineSelected:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "mineSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "mineSelected")
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	Minesloop:
	GLAF A 1 A_OVERLAY(2,"AMMOMENUSHOW")
	TNT1 A 0 ACS_NamedExecute("selectmines",0)
	TNT1 A 0 ACS_NamedExecute("GRENADEQUANTITY",0)
	TNT1 A 0 SetPlayerProperty(0,1,4)
	TNT1 A 0 A_jumpifinventory("choosingreward",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVELEFT, "ClusterSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_MOVERIGHT, "FlareSelected")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_BACK, "AmmomenuCancel")
	TNT1 A 0 A_jumpifinventory("Startdualwield",1,"Ammomenucancel")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_ATTACK, "LoadMine")
	TNT1 A 0 A_JumpIf(GetPlayerInput(INPUT_BUTTONS) & BT_USE, "LoadMine")
	loop
	
	AmmomenuShow:
		GMEN U 5 BRIGHT
		TNT1 A 0 {if(GetCVAR("bd_SmartCrosshairs") == 1){A_SetCrosshair(GetCVAR("GLCrosshair"));}else{A_SetCrosshair(0);}}			
		stop
	
	/////////////// LOAD
	
	LoadFlare:
	TNT1 A 0 A_jumpifinventory("FLARE",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO FLARESELECTED
	TNT1 A 0 A_takeinventory("acidloaded",1)
	TNT1 A 0 A_takeinventory("hellfireloaded",1)
	TNT1 A 0 A_takeinventory("syringeloaded",1)
	TNT1 A 0 A_takeinventory("metalloaded",1)
	TNT1 A 0 A_takeinventory("grenadeloaded",1)
	TNT1 A 0 A_takeinventory("clusterloaded",1)
	TNT1 A 0 A_takeinventory("mineloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("flareloaded",1)
	TNT1 A 0 A_overlay(3,"FLAREOVERLAY")
	goto Reload
	FlareOverlay:
	TNT1 A 0
	NFLS ABCDEFGGFEDCBA 1
	TNT1 A 0 
	STOP
	
	LoadAcid:
	TNT1 A 0 A_jumpifinventory("acidmistammo",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO acidselected
	TNT1 A 0 A_takeinventory("flareloaded",1)
	TNT1 A 0 A_takeinventory("hellfireloaded",1)
	TNT1 A 0 A_takeinventory("syringeloaded",1)
	TNT1 A 0 A_takeinventory("metalloaded",1)
	TNT1 A 0 A_takeinventory("grenadeloaded",1)
	TNT1 A 0 A_takeinventory("clusterloaded",1)
	TNT1 A 0 A_takeinventory("mineloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("acidloaded",1)
	TNT1 A 0 A_overlay(3,"ACIDoverlay")
	GOTO RELOAD
	ACIDOverlay:
	TNT1 A 0
	ACIS ABDDD 2 A_overlayoffset(3,40,0)
	ACIS D 1 A_overlayoffset(3,40,8)
	ACIS D 1 A_overlayoffset(3,40,16)
	ACIS D 1 A_overlayoffset(3,40,24)
	ACIS D 1 A_overlayoffset(3,40,32)
	TNT1 A 0 
	STOP
	
	LoadHellfire:
	TNT1 A 0 A_jumpifinventory("hellfireammo",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO hellfireselected
	TNT1 A 0 A_takeinventory("flareloaded",1)
	TNT1 A 0 A_takeinventory("acidloaded",1)
	TNT1 A 0 A_takeinventory("syringeloaded",1)
	TNT1 A 0 A_takeinventory("metalloaded",1)
	TNT1 A 0 A_takeinventory("grenadeloaded",1)
	TNT1 A 0 A_takeinventory("clusterloaded",1)
	TNT1 A 0 A_takeinventory("mineloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("hellfireloaded",1)
	TNT1 A 0 A_overlay(3,"HELLFIREoverlay")
	GOTO RELOAD
	HELLFIREOverlay:
	TNT1 A 0
	HELS ABCDD 2 A_overlayoffset(3,40,0)
	HELS D 1 A_overlayoffset(3,40,8)
	HELS D 1 A_overlayoffset(3,40,16)
	HELS D 1 A_overlayoffset(3,40,24)
	HELS D 1 A_overlayoffset(3,40,32)
	TNT1 A 0 
	STOP
	
	LoadSyringe:
	TNT1 A 0 A_jumpifinventory("pheromones",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO syringeselected
	TNT1 A 0 A_takeinventory("flareloaded",1)
	TNT1 A 0 A_takeinventory("acidloaded",1)
	TNT1 A 0 A_takeinventory("hellfireloaded",1)
	TNT1 A 0 A_takeinventory("metalloaded",1)
	TNT1 A 0 A_takeinventory("grenadeloaded",1)
	TNT1 A 0 A_takeinventory("clusterloaded",1)
	TNT1 A 0 A_takeinventory("mineloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("syringeloaded",1)
	//animation
	goto Reload
	
	LoadMetal:
	TNT1 A 0 A_jumpifinventory("scrapmetal",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO metalselected
	TNT1 A 0 A_takeinventory("flareloaded",1)
	TNT1 A 0 A_takeinventory("acidloaded",1)
	TNT1 A 0 A_takeinventory("hellfireloaded",1)
	TNT1 A 0 A_takeinventory("syringeloaded",1)
	TNT1 A 0 A_takeinventory("grenadeloaded",1)
	TNT1 A 0 A_takeinventory("clusterloaded",1)
	TNT1 A 0 A_takeinventory("mineloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("metalloaded",1)
	//animation
	goto Reload
	
	LoadGrenade:
	TNT1 A 0 A_jumpifinventory("grenadeammo",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO grenadeselected
	TNT1 A 0 A_takeinventory("flareloaded",1)
	TNT1 A 0 A_takeinventory("acidloaded",1)
	TNT1 A 0 A_takeinventory("hellfireloaded",1)
	TNT1 A 0 A_takeinventory("syringeloaded",1)
	TNT1 A 0 A_takeinventory("metalloaded",1)
	TNT1 A 0 A_takeinventory("clusterloaded",1)
	TNT1 A 0 A_takeinventory("mineloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("grenadeloaded",1)
	TNT1 A 0 A_overlay(3,"grenadeoverlay")
	goto Reload
	GrenadeOverlay:
	TNT1 A 0
	GRHE ABCDEFGHIJKLM 1 A_overlayoffset(3,40,0)
	TNT1 A 0 
	STOP
	
	LoadCluster:
	TNT1 A 0 A_jumpifinventory("clusterammo",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO clusterselected
	TNT1 A 0 A_takeinventory("flareloaded",1)
	TNT1 A 0 A_takeinventory("acidloaded",1)
	TNT1 A 0 A_takeinventory("hellfireloaded",1)
	TNT1 A 0 A_takeinventory("syringeloaded",1)
	TNT1 A 0 A_takeinventory("metalloaded",1)
	TNT1 A 0 A_takeinventory("grenadeloaded",1)
	TNT1 A 0 A_takeinventory("mineloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("clusterloaded",1)
	TNT1 A 0 A_overlay(3,"CLUSTERoverlay")
	goto Reload
	CLUSTEROverlay:
	TNT1 A 0 
	CLU5 ABCDEFGHIJKLMN 1 A_overlayoffset(3,40,0)
	TNT1 A 0 
	STOP
	
	LoadMine:
	TNT1 A 0 A_jumpifinventory("PROXBOMBAMMO",1,2)
	TNT1 A 0 A_PRINT("$NOGLAMMO")
	GOTO mineselected
	TNT1 A 0 A_takeinventory("flareloaded",1)
	TNT1 A 0 A_takeinventory("acidloaded",1)
	TNT1 A 0 A_takeinventory("hellfireloaded",1)
	TNT1 A 0 A_takeinventory("syringeloaded",1)
	TNT1 A 0 A_takeinventory("metalloaded",1)
	TNT1 A 0 A_takeinventory("grenadeloaded",1)
	TNT1 A 0 A_takeinventory("clusterloaded",1)
	
	TNT1 A 0 A_SetCrosshair(41)		
	TNT1 A 0 SetPlayerProperty(0,0,4)
	TNT1 A 0 A_takeinventory("Startdualwield",1)
	TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
	TNT1 A 0 A_giveinventory("mineloaded",1)
	TNT1 A 0 A_jumpifinventory("DETONATIONMODE",1,2)
	TNT1 A 0 A_overlay(3,"MINEoverlay")
	goto reload
	TNT1 A 0 A_overlay(3,"REMOTEoverlay")
	goto Reload
	REMOTEOVERLAY:
	TNT1 A 0 
	PR0X NABCDEFGHIJKLM 1 A_overlayoffset(3,40,0)
	TNT1 A 0 
	STOP
	MINEOVERLAY:
	TNT1 A 0 
	PR0X NOPQRSTUVWXY 1 A_overlayoffset(3,40,0)
	TNT1 A 0 
	STOP
	
	AmmomenuCancel:
		TNT1 A 0 A_SetCrosshair(41)		
		TNT1 A 0 SetPlayerProperty(0,0,4)
		TNT1 A 0 A_takeinventory("Startdualwield",1)
		TNT1 A 0 ACS_NamedExecute("CLEARGLSELECT",0)
		goto Ready3
		
///////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////// 
///////////////////////////////////////////////////////////////////////////////////

	
	KITREPAIR:
		TNT1 A 0 A_JumpIFInventory("survivalkituses",1, 2)
		PIST F 0 A_Jump(256,"kitbroke")
		GLAF A 5
		
		TNT1 A 0 A_JumpIFInventory("GLDurability",80, "NoNeedRepair")
		PIST F 0 A_JumpIfInventory("scrapmetal",1, 2)
		PIST F 0 A_Jump(256,"outofmetal")
		
	KITREPAIR2:
		PIST F 0 A_GIVEinventory("GLDurability",20)
		BADF A 0 A_Takeinventory("survivalkituses",1)
		BADF A 0 A_Takeinventory("scrapmetal",1)
		TNT1 A 0 A_playsound("WIRECUT",1)
		GLAS JIHGFEDCBA 1
		TNT1 A 28
		GLAS ABCDEFGHIJJ 1
		
		TNT1 A 0 A_JumpIFInventory("survivalkituses",1, 2)
		PIST F 0 A_Jump(256,"kitbroke")
		GLAF A 2
		goto Ready3	

	DokickGL:
		TNT1 A 0 A_JumpIfInventory("isdoomguy", 1, 4)
		TNT1 A 0 A_JumpIfInventory("LARGESTAMINA", 1, 2)
		TNT1 A 0 A_JumpifInventory("UsedStamina",95,4)
		TNT1 A 0 A_JumpifInventory("UsedStamina",1995,3)
		TNT1 A 0 A_overlay(3,"kickGL")
		TNT1 A 0 a_Jump(256,"Dokick")
		goto Ready3
		TNT1 A 0 A_overlay(3,"kickGLtired")
		TNT1 A 0 a_Jump(256,"Dokick")
		goto Ready3	
	kickGL:
		GLAS DEF 1
		GLAS G 12 
		GLAS FED 1 
		TNT1 A 0 A_JumpIfInventory("AIRKICKING", 1, 2)
		TNT1 A 0 A_JumpIfInventory("isSliding", 1, 2)
		stop
		GLAS D 2
		STOP
		GLAS HGFEDCBA 1
		TNT1 A 2
		STOP
	kickGLtired:
		GLAS DEF 2 
		GLAS G 37 
		GLAS FED 2 
		STOP	


	Spawn:
		GLAP A -1
		Stop
		
	}
}


ACTOR flareloaded : Inventory {Inventory.MaxAmount 1}
ACTOR acidloaded : Inventory {Inventory.MaxAmount 1}
ACTOR hellfireloaded : Inventory {Inventory.MaxAmount 1}
ACTOR syringeloaded : Inventory {Inventory.MaxAmount 1}
ACTOR metalloaded : Inventory {Inventory.MaxAmount 1}
ACTOR grenadeloaded : Inventory {Inventory.MaxAmount 1}
ACTOR clusterloaded : Inventory {Inventory.MaxAmount 1}
ACTOR mineloaded : Inventory {Inventory.MaxAmount 1}
ACTOR hacktoolloaded : Inventory {Inventory.MaxAmount 1}



///////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////// PROJECTILES
///////////////////////////////////////////////////////////////////////////////////


Actor ActiveFlareGL
{
	Radius 6
	Height 6
	Projectile
	Speed 60
    Damage (random (35, 35))
	Damagetype "Fire"
    Gravity 0.70
	+MISSILE
    +noblood
	-nogravity
	-EXTREMEDEATH
	+BOUNCEONFLOORS
	+BOUNCEONWALLS
	+BOUNCEONCEILINGS
	-NOTELEPORT
	+THRUSPECIES
	+explodeonwater
	+dropoff
	+touchy
	+floorclip
	+shootable
	health 10
	Species "Marines"
	BounceFactor 0.5
	BounceCount 3
	WallBounceFactor 0.5
    SeeSound "GRNBNCE"
	DeathSound "none"
  scale 0.18
  States
  {
	Spawn:
		TNT1 A 0 	
		FFLA HRFEDCBA 2 BRIGHT A_JumpIf(waterlevel > 1, "Splash")
		loop

	Death:
		FFLA HRHFHR 2 BRIGHT
		FFLA P 0 Bright A_PlaySoundEx("Flare/Loop", "SoundSlot7", 1, -1)
		FFLA PQR 2 Bright
	Death.water:
		FFLA P 1 A_SPAWNITEM("ActiveFlareWaiting",0,0)
		Stop
		
		Splash:
		TNT1 A 0 A_die("water")
		stop
		
  }
 }

Actor EXPLODINGFlare : switchabledecoration
{
	Radius 6
	Height 6
	Projectile
	Speed 90
    Damage (random (35, 35))
	Damagetype "Fire"
    Gravity 0.5
	Projectile
	Decal "smallburn"
	+MISSILE
    -NOGRAVITY
    -BLOODSPLATTER
	-EXTREMEDEATH
	-NOTELEPORT
	+THRUSPECIES
	+USESPECIAL
	Activation THINGSPEC_Activate
	Species "Marines"
    Health 5
	DeathSound "none"
  scale 0.32
  Radius 15
  Height 11
  +touchy
  States
  {
  Spawn:
    FLAR F 0 Bright
    FLAR F 0 Bright 
	
	Midair:
    MISL A 1 Bright
	LOOP
	
	CRASH:
	XDEATH:
	Death:
	TNT1 A 0 A_SPAWNITEM("BROKENFLARE")
	TNT1 A 0 A_SPAWNITEMex("fireembers",0,0,0)
	TNT1 A 0 a_changeflag("Nogravity",1)
	TNT1 A 0 A_EXPLODE(25,60,0,1,60,0,0,"HITPUFF","FIRE")
    EFIR ABCDEFGHIJKLM 2 Bright
	TNT1 A 1
	Stop
  }
}


Actor ACIDMISTGL2 : EXPLODINGFlare
{
    Damage (random (100, 100))
	Damagetype "ACID"
	POISONDAMAGE 150, 15, 35
	POISONDAMAGETYPE "ACID"
	DECAL"acidspurt"
	+ADDITIVEPOISONDAMAGE
	+ADDITIVEPOISONDURATION
  States
  {
  Spawn:
    GLSY F 0 Bright
    GLSY F 0 Bright 
	
	Midair:
    GLSY A 35 Bright
	
	CRASH:
	XDEATH:
	Death:
	TNT1 A 0 a_changeflag("Nogravity",1)
	TNT1 A 0 A_EXPLODE(20,60,0,1,60,0,0,"HITPUFF","ACID")
	FRPG JKABCDEFGH 2 Bright
	TNT1 A 1
	Stop
  }
}

Actor SYRINGEGL1 : EXPLODINGFlare
{
    Damage (random (1, 1))
	Damagetype "SYRINGE1"
	Decal "SmallBurn"
	+FORCEPAIN

  States
  {
  Spawn:
    GLSY F 0 Bright
    GLSY F 0 Bright 
	
	Midair:
    GLSY A 35 Bright
	
	CRASH:
	XDEATH:
	Death:
	TNT1 A 1
	Stop
  }
}

Actor SYRINGEGL2 : SYRINGEGL1
{
Damagetype "SYRINGE2"
DeathSound "GLASSEXP"
Decal "BulletDecalNew1"
  States
  {
  Spawn:
    GLSY F 0 Bright
    GLSY F 0 Bright 
	
	Midair:
    GLSY A 35 Bright
	
	CRASH:
	XDEATH:
	Death:
	TNT1 A 0
	TNT1 A 0 A_explode(1,400, XF_EXPLICITDAMAGETYPE | XF_NOSPLASH | XF_NOTMISSILE,0,300,0,0,"Bulletpuff","SYRINGE2")
	TNT1 A 1
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,0,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,-45,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,-90,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,45,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,90,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,-130,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,130,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,-20,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,20,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,-60,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,60,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,-160,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,160,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,180,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,-160,CMF_OFFSETPITCH,-180)
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,160,CMF_OFFSETPITCH,-180)
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,25,180,CMF_OFFSETPITCH,-180)		
		TNT1 A 5
		///second layer
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,0,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,-45,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,-90,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,45,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,90,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,-130,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,130,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,-20,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,20,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,-60,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,60,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,-160,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,160,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,180,CMF_OFFSETPITCH,random(-10,-5))
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,-160,CMF_OFFSETPITCH,-180)
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,160,CMF_OFFSETPITCH,-180)
		TNT1 A 0 A_CustomMissile("pheromonesmoke",10,70,180,CMF_OFFSETPITCH,-180)
	Stop
  }
}

Actor SPIKEGL2
{
  Projectile
  Radius 3
  Height 3
  Speed 80
  GRAVITY 0.5
  Damage 60
  Scale 0.8
  DAMAGETYPE "SLUG"
  +RIPPER
  +movewithsector
  +PIERCEARMOR
  +BloodSplatter
  -nogravity
  SeeSound ""
  DeathSound ""
  Decal BulletChip
  States
  {
  Spawn:
	TNT1 A 0
	NLPJ A 0 A_PlaySound("Weapons/NailFlight")
	
	FLY:
	 TNT1 A 0 A_FaceMovementDirection(0,360,180)
	 NLPJ A 1 A_SpawnItemEx("NailBlur", 0, 0, 0, 1, 0, 0, 180, 128)
	 LOOP
	
	xdeath:
	CRASH:
	NLPJ B 0 A_PlaySound("Weapons/NailHitBleed")
	NLPJ BCDEFG 2
	STOP
	
  Death:
	NLPJ B 0 A_PlaySound("Weapons/NailHit")
    NLPJ A 1 A_Changeflag("nogravity",1)
	NLPJ A -1
    Stop

  }
}

Actor NailBlur       
{
  Height 8
  Radius 1
  Damage 0
  Scale 0.6
  Speed 0.2
  RenderStyle Translucent
  Alpha 0.5
  +NoGravity
  +DropOff
  +NoTeleport
  States
  {
  Spawn:
    NLPJ A 1 A_FadeOut(0.4)
    Loop
  }
}
